import{r as l,j as e,L}from"./index-DFEJPJpx.js";import{s as b}from"./Hooks-D2wXxCIG.js";const r=({label:i,type:c,name:s,value:m,onChange:x,placeholder:g,required:p})=>e.jsxs("div",{className:"inputGroup",children:[e.jsx("label",{htmlFor:s,children:i}),c==="textarea"?e.jsx("textarea",{name:s,id:s,placeholder:g,rows:5,value:m,onChange:x,required:p}):e.jsx("input",{type:c,name:s,id:s,placeholder:g,value:m,onChange:x,required:p})]}),k=()=>{const[i,c]=l.useState(1),[s,m]=l.useState({name:"",email:"",phone:"",address:"",shopName:"",shopAddress:""}),[x,g]=l.useState(null),[p,n]=l.useState(""),[v,f]=l.useState(!1),[S,P]=l.useState(!1),[y,j]=l.useState(""),[d,N]=l.useState({lat:null,lon:null});l.useEffect(()=>{(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(t=>{const{latitude:o,longitude:u}=t.coords;N({lat:o,lon:u})},t=>{console.error("Error fetching location:",t),N({lat:null,lon:null})})})()},[]);const C=()=>{const{name:a,email:t,phone:o,address:u}=s;a&&t&&o&&u?(n(""),c(2)):n("Please fill all personal details"),b()},T=async()=>{const{email:a}=s;try{const o=await(await fetch("https://chagans.com/user/sendOtp",{method:"POST",headers:{"Content-Type":"application/json","X-Latitude":d.lat,"X-Longitude":d.lon},body:JSON.stringify({email:a})})).json();o.code===200&&j(o.otp)}catch(t){console.error(t)}},E=()=>{const{shopName:a,shopAddress:t}=s;a&&t?(c(3),j(),n(""),T()):n("Please fill all shop details"),b()},O=async()=>{try{(await(await fetch("https://chagans.com/user/verifyOtp",{method:"POST",headers:{"Content-Type":"application/json",latitude:d.lat,longitude:d.lon},body:JSON.stringify({otp:y,email:s.email,phoneNumber:s.phone,name:s.name,address:s.address,companyDetials:{shopName:s.shopName,shopAddress:s.shopAddress}})})).json()).code===200?(c(4),n("")):n("Please enter a valid OTP")}catch(a){console.error(a)}},h=a=>{const{name:t,value:o}=a.target;m(u=>({...u,[t]:o}))},A=async()=>{f(!0),n("");const a=new FormData;a.append("userProfileImage",x),a.append("email",s.email);try{(await(await fetch("https://chagans.com/user/userProfile",{method:"POST",headers:{latitude:d.lat,longitude:d.lon},body:a})).json()).code===200?P(!0):n("Registration failed. Please try again.")}catch{n("An error occurred. Please try again.")}finally{f(!1)}};return e.jsxs("main",{children:[e.jsxs("div",{className:"register-header",children:[e.jsx("h1",{children:"Register"}),e.jsxs("p",{children:["Already have an account? ",e.jsx(L,{to:"/login",children:"Login"})]})]}),e.jsx("div",{className:"register-container",children:e.jsxs("div",{className:"register-form",children:[i===1&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"subTitle",children:"Personal Details"}),e.jsxs("div",{className:"inputGroups",children:[e.jsx(r,{label:"Name",type:"text",name:"name",value:s.name,onChange:h,placeholder:"Enter your name"}),e.jsx(r,{label:"Email",type:"email",name:"email",value:s.email,onChange:h,placeholder:"Enter your email"}),e.jsx(r,{label:"Phone",type:"tel",name:"phone",value:s.phone,onChange:h,placeholder:"Enter your mobile"}),e.jsx(r,{label:"Address",type:"textarea",name:"address",value:s.address,onChange:h,placeholder:"Enter your address"})]}),e.jsx("button",{className:"nextBtn",onClick:C,children:"Next"})]}),i===2&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"subTitle",children:"Shop Details"}),e.jsxs("div",{className:"inputGroups",children:[e.jsx(r,{label:"Shop Name",type:"text",name:"shopName",value:s.shopName,onChange:h,placeholder:"Enter your shop name"}),e.jsx(r,{label:"Shop Address",type:"textarea",name:"shopAddress",value:s.shopAddress,onChange:h,placeholder:"Enter your shop address"})]}),e.jsx("button",{className:"nextBtn",onClick:E,children:"Next"})]}),i===3&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"subTitle",children:"OTP Verification"}),e.jsx("div",{className:"inputGroups",children:e.jsx(r,{label:"Enter OTP",type:"text",name:"otp",value:y,onChange:a=>j(a.target.value),placeholder:"Enter OTP"})}),e.jsx("button",{className:"nextBtn",onClick:O,children:"Verify"})]}),i===4&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"subTitle",children:"User Profile"}),e.jsx("div",{className:"inputGroups",children:e.jsx(r,{label:"Upload Profile",type:"file",name:"profile",onChange:a=>g(a.target.files[0])})}),e.jsx("button",{className:"nextBtn",onClick:A,children:v?"Submitting...":"Submit"}),S&&e.jsx("p",{className:"success-message",children:"Registration Successful!"})]}),p&&e.jsx("p",{className:"error-message",children:p})]})})]})};export{k as default};
