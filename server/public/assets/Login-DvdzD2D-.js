import{r as l,u as b,j as s,s as v}from"./index-DFEJPJpx.js";/* empty css              */const E=()=>{const[c,r]=l.useState(!1),[e,u]=l.useState(null),[d,m]=l.useState(!1),[i,h]=l.useState({}),[a,g]=l.useState(null),p=b();l.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:n,longitude:o}=t.coords;g({latitude:n,longitude:o})},t=>{console.error("Error fetching location: ",t)}):console.error("Geolocation is not supported by this browser.")},[]);const f=async()=>{if(!a){console.error("Location not available. Cannot make API call.");return}r(!0);const o=await(await fetch("https://chagans.com/user/login",{method:"POST",headers:{"Content-Type":"application/json",Latitude:a.latitude,Longitude:a.longitude},body:JSON.stringify(i)})).json();u(o),m(o.success),r(!1)},x=async()=>{if(!a){console.error("Location not available. Cannot make API call.");return}r(!0);const o=await(await fetch("https://chagans.com/user/verifyLoginOtp",{method:"POST",headers:{"Content-Type":"application/json",Latitude:a.latitude,Longitude:a.longitude},body:JSON.stringify(i)})).json();u(o),v("token",o.token,1),o.code===200&&p("/admin/dashboard",{replace:!0,state:o.userData}),o.code===403&&m(!1),r(!1)},j=t=>{t.preventDefault(),d?x():f()};return s.jsxs("main",{className:"login max-width",children:[s.jsx("h1",{className:"subTitle",children:"Merchant Login"}),s.jsxs("form",{onSubmit:j,className:c?"loading":"",children:[s.jsxs("div",{className:"inputField",children:[s.jsx("label",{htmlFor:"email",children:"Email"}),s.jsx("input",{type:"email",required:!0,value:i.email||"",onChange:t=>h(n=>({...n,email:t.target.value})),placeholder:"Enter Your Email"})]}),d&&s.jsxs("div",{className:"inputField",children:[s.jsx("label",{htmlFor:"otp",children:"Enter Otp"}),s.jsx("input",{type:"text",required:!0,value:i.otp||"",maxLength:6,pattern:"^[0-9]{6}$",onChange:t=>h(n=>({...n,otp:t.target.value})),placeholder:"Enter Otp"})]}),(e==null?void 0:e.message)&&s.jsxs("p",{className:`msg ${(e==null?void 0:e.code)===200&&"success"}`,children:[e==null?void 0:e.message,e!=null&&e.attemptLeft?`(${e==null?void 0:e.attemptLeft} attempts left)`:""]}),s.jsx("button",{type:"submit",disabled:c,children:(e==null?void 0:e.code)!==200?"Submit":"Verify OTP"})]})]})};export{E as default};
