import{r as a,u as j,j as s,s as y}from"./index-DFEJPJpx.js";/* empty css              */const S=()=>{const[r,l]=a.useState(!1),[e,c]=a.useState(null),[u,d]=a.useState(!1),[i,m]=a.useState({}),[b,h]=a.useState(null),g=j();a.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const{latitude:n,longitude:o}=t.coords;h({latitude:n,longitude:o})},t=>{console.error("Error fetching location: ",t)}):console.error("Geolocation is not supported by this browser.")},[]);const p=async()=>{l(!0);const o=await(await fetch("https://chagans.com/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();c(o),d(o.success),l(!1)},f=async()=>{l(!0);const o=await(await fetch("https://chagans.com/admin/verifyOtp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();c(o),y("token",o.token,1),o.code===200&&g("/admin/dashboard"),o.code===403&&d(!1),l(!1)},x=t=>{t.preventDefault(),u?f():p()};return s.jsx("main",{className:"login max-width",children:s.jsxs("form",{onSubmit:x,className:r?"loading":"",children:[s.jsx("h1",{className:"subTitle",children:"Admin Login"}),s.jsxs("div",{className:"inputField",children:[s.jsx("label",{htmlFor:"email",children:"Email"}),s.jsx("input",{type:"email",required:!0,value:i.email||"",onChange:t=>m(n=>({...n,email:t.target.value})),placeholder:"Enter Your Email"})]}),u&&s.jsxs("div",{className:"inputField",children:[s.jsx("label",{htmlFor:"otp",children:"Enter Otp"}),s.jsx("input",{type:"text",required:!0,value:i.otp||"",maxLength:6,pattern:"^[0-9]{6}$",onChange:t=>m(n=>({...n,otp:t.target.value})),placeholder:"Enter Otp"})]}),(e==null?void 0:e.message)&&s.jsxs("p",{className:`msg ${(e==null?void 0:e.code)===200&&"success"}`,children:[e==null?void 0:e.message,e!=null&&e.attemptLeft?`(${e==null?void 0:e.attemptLeft} attempts left)`:""]}),s.jsx("button",{type:"submit",disabled:r,children:(e==null?void 0:e.code)!==200?"Submit":"Verify OTP"})]})})};export{S as default};
